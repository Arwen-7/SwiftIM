# ä¼šè¯æœªè¯»è®¡æ•°æŠ€æœ¯æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•
1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
3. [æŠ€æœ¯æ–¹æ¡ˆ](#æŠ€æœ¯æ–¹æ¡ˆ)
4. [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
5. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)

---

## æ¦‚è¿°

### ä»€ä¹ˆæ˜¯ä¼šè¯æœªè¯»è®¡æ•°ï¼Ÿ

**ä¼šè¯æœªè¯»è®¡æ•°**æ˜¯æŒ‡ç»Ÿè®¡æ¯ä¸ªä¼šè¯ä¸­ç”¨æˆ·æœªè¯»çš„æ¶ˆæ¯æ•°é‡ï¼Œå¹¶åœ¨ä¼šè¯åˆ—è¡¨ä¸­æ˜¾ç¤ºå°çº¢ç‚¹æˆ–æ•°å­—è§’æ ‡ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦æœªè¯»è®¡æ•°ï¼Ÿ

**åœºæ™¯ï¼šç”¨æˆ·æœ‰å¤šä¸ªèŠå¤©ä¼šè¯**

**æ— æœªè¯»è®¡æ•°ï¼ˆä¸å¥½ï¼‰**ï¼š
```
ä¼šè¯åˆ—è¡¨ï¼š
  - å¼ ä¸‰
  - æå››
  - ç‹äº”

é—®é¢˜ï¼š
  - ä¸çŸ¥é“å“ªä¸ªä¼šè¯æœ‰æ–°æ¶ˆæ¯
  - ä¸çŸ¥é“æœ‰å¤šå°‘æ¡æœªè¯»
  - å®¹æ˜“é—æ¼é‡è¦æ¶ˆæ¯
  - ç”¨æˆ·ä½“éªŒï¼šâŒ å·®
```

**æœ‰æœªè¯»è®¡æ•°ï¼ˆå¥½ï¼‰**ï¼š
```
ä¼šè¯åˆ—è¡¨ï¼š
  - å¼ ä¸‰ [5]    â† 5æ¡æœªè¯»
  - æå›› [99+]  â† 99+æ¡æœªè¯»
  - ç‹äº”        â† å·²è¯»

æ•ˆæœï¼š
  âœ… ä¸€ç›®äº†ç„¶å“ªä¸ªä¼šè¯æœ‰æ–°æ¶ˆæ¯
  âœ… çŸ¥é“æœªè¯»æ•°é‡
  âœ… æ€»è§’æ ‡æé†’ï¼ˆApp å›¾æ ‡ï¼‰
  âœ… ç”¨æˆ·ä½“éªŒï¼šä¼˜ç§€
```

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. æœªè¯»è®¡æ•°æ¥æº

```swift
// æœªè¯»æ¶ˆæ¯æ¥æº
1. æ¥æ”¶æ–°æ¶ˆæ¯ï¼ˆå¯¹æ–¹å‘æ¥çš„ï¼‰
2. åŒæ­¥ç¦»çº¿æ¶ˆæ¯ï¼ˆç™»å½•æ—¶ï¼‰
3. å…¶ä»–è®¾å¤‡å·²è¯»ï¼ˆå¤šç«¯åŒæ­¥ï¼‰
```

### 2. å·²è¯»æ ‡è®°

```swift
// æ ‡è®°å·²è¯»çš„æ—¶æœº
1. æ‰“å¼€ä¼šè¯
2. æŸ¥çœ‹æ¶ˆæ¯
3. æ‰‹åŠ¨æ ‡è®°ä¸ºå·²è¯»
4. å…¶ä»–è®¾å¤‡å·²è¯»ï¼ˆåŒæ­¥ï¼‰
```

### 3. æœªè¯»è®¡æ•°è§„åˆ™

```swift
// è®¡æ•°è§„åˆ™
æœªè¯»æ•° = æ”¶åˆ°çš„æ¶ˆæ¯æ•° - å·²è¯»çš„æ¶ˆæ¯æ•°

// ç‰¹æ®Šè§„åˆ™
- è‡ªå·±å‘é€çš„æ¶ˆæ¯ï¼šä¸è®¡å…¥æœªè¯»
- å·²æ’¤å›çš„æ¶ˆæ¯ï¼šå‡å°‘æœªè¯»æ•°
- å·²è¯»æ¶ˆæ¯ï¼šä»æœªè¯»ä¸­ç§»é™¤
- ç³»ç»Ÿæ¶ˆæ¯ï¼šå¯é…ç½®æ˜¯å¦è®¡å…¥
```

---

## æŠ€æœ¯æ–¹æ¡ˆ

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          UITableView (ä¼šè¯åˆ—è¡¨)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cell 1: å¼ ä¸‰  [5]   â† æ˜¾ç¤ºæœªè¯»æ•°    â”‚ â”‚
â”‚  â”‚  Cell 2: æå››  [99+]                 â”‚ â”‚
â”‚  â”‚  Cell 3: ç‹äº”                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     IMConversationManager                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  getUnreadCount(conversationID)       â”‚ â”‚
â”‚  â”‚  markAsRead(conversationID)           â”‚ â”‚
â”‚  â”‚  getTotalUnreadCount()                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         IMConversation (Realm)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  unreadCount: Int                     â”‚ â”‚
â”‚  â”‚  lastReadTime: Int64                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

#### æ”¶åˆ°æ–°æ¶ˆæ¯
```
æ”¶åˆ°æ–°æ¶ˆæ¯
   â”‚
   â”œâ”€ åˆ¤æ–­ï¼šæ˜¯å¦æ˜¯è‡ªå·±å‘çš„ï¼Ÿ
   â”‚   â””â”€ æ˜¯ â†’ ä¸å¢åŠ æœªè¯»æ•°
   â”‚   â””â”€ å¦ â†’ ç»§ç»­
   â”‚
   â”œâ”€ åˆ¤æ–­ï¼šå½“å‰æ˜¯å¦åœ¨è¯¥ä¼šè¯ï¼Ÿ
   â”‚   â””â”€ æ˜¯ â†’ æ ‡è®°ä¸ºå·²è¯»ï¼Œä¸å¢åŠ 
   â”‚   â””â”€ å¦ â†’ æœªè¯»æ•° +1
   â”‚
   â”œâ”€ æ›´æ–°ä¼šè¯æœªè¯»æ•°
   â”‚
   â””â”€ é€šçŸ¥ UI åˆ·æ–°
```

#### æ ‡è®°å·²è¯»
```
æ‰“å¼€ä¼šè¯
   â”‚
   â”œâ”€ è·å–ä¼šè¯æœªè¯»æ•°
   â”‚
   â”œâ”€ æ ‡è®°æ‰€æœ‰æ¶ˆæ¯ä¸ºå·²è¯»
   â”‚   â””â”€ æ›´æ–° lastReadTime
   â”‚
   â”œâ”€ æœªè¯»æ•°æ¸…é›¶
   â”‚
   â””â”€ é€šçŸ¥ UI åˆ·æ–°
```

---

## å®ç°ç»†èŠ‚

### 1. æ•°æ®æ¨¡å‹æ‰©å±•

```swift
// IMConversation.swift

public class IMConversation: Object {
    // ... ç°æœ‰å­—æ®µ ...
    
    /// æœªè¯»æ¶ˆæ¯æ•°
    @Persisted public var unreadCount: Int = 0
    
    /// æœ€åå·²è¯»æ—¶é—´ï¼ˆç”¨äºåˆ¤æ–­å“ªäº›æ¶ˆæ¯æœªè¯»ï¼‰
    @Persisted public var lastReadTime: Int64 = 0
    
    /// æ˜¯å¦å…æ‰“æ‰°ï¼ˆå…æ‰“æ‰°æ—¶ä¸è®¡å…¥æ€»æœªè¯»ï¼‰
    @Persisted public var isMuted: Bool = false
}
```

### 2. æ•°æ®åº“æ–¹æ³•

```swift
// IMDatabaseManager.swift

extension IMDatabaseManager {
    
    /// å¢åŠ æœªè¯»æ•°
    public func incrementUnreadCount(conversationID: String, by count: Int = 1) throws {
        let realm = try getRealm()
        
        try realm.write {
            if let conversation = realm.object(ofType: IMConversation.self, forPrimaryKey: conversationID) {
                conversation.unreadCount += count
                conversation.updateTime = IMUtils.currentTimeMillis()
            }
        }
    }
    
    /// æ¸…ç©ºæœªè¯»æ•°
    public func clearUnreadCount(conversationID: String) throws {
        let realm = try getRealm()
        
        try realm.write {
            if let conversation = realm.object(ofType: IMConversation.self, forPrimaryKey: conversationID) {
                conversation.unreadCount = 0
                conversation.lastReadTime = IMUtils.currentTimeMillis()
            }
        }
    }
    
    /// è·å–æœªè¯»æ•°
    public func getUnreadCount(conversationID: String) -> Int {
        do {
            let realm = try getRealm()
            return realm.object(ofType: IMConversation.self, forPrimaryKey: conversationID)?.unreadCount ?? 0
        } catch {
            IMLogger.shared.error("Failed to get unread count: \(error)")
            return 0
        }
    }
    
    /// è·å–æ€»æœªè¯»æ•°ï¼ˆæ’é™¤å…æ‰“æ‰°ï¼‰
    public func getTotalUnreadCount() -> Int {
        do {
            let realm = try getRealm()
            let conversations = realm.objects(IMConversation.self)
                .filter("isMuted == false")
            
            return conversations.reduce(0) { $0 + $1.unreadCount }
        } catch {
            IMLogger.shared.error("Failed to get total unread count: \(error)")
            return 0
        }
    }
    
    /// è®¡ç®—ä¼šè¯æœªè¯»æ•°ï¼ˆåŸºäºæ¶ˆæ¯æ—¶é—´ï¼‰
    public func calculateUnreadCount(conversationID: String) -> Int {
        do {
            let realm = try getRealm()
            
            guard let conversation = realm.object(ofType: IMConversation.self, forPrimaryKey: conversationID) else {
                return 0
            }
            
            let lastReadTime = conversation.lastReadTime
            
            // ç»Ÿè®¡åœ¨ lastReadTime ä¹‹åçš„æœªè¯»æ¶ˆæ¯
            let unreadMessages = realm.objects(IMMessage.self)
                .filter("conversationID == %@ AND createTime > %@ AND direction == %@ AND isDeleted == false",
                       conversationID, lastReadTime, IMMessageDirection.receive.rawValue)
            
            return unreadMessages.count
        } catch {
            IMLogger.shared.error("Failed to calculate unread count: \(error)")
            return 0
        }
    }
}
```

### 3. ä¸šåŠ¡å±‚æ–¹æ³•

```swift
// IMConversationManager.swift

extension IMConversationManager {
    
    /// è·å–ä¼šè¯æœªè¯»æ•°
    public func getUnreadCount(conversationID: String) -> Int {
        return database.getUnreadCount(conversationID: conversationID)
    }
    
    /// æ ‡è®°ä¼šè¯ä¸ºå·²è¯»
    public func markAsRead(conversationID: String) throws {
        try database.clearUnreadCount(conversationID: conversationID)
        
        // é€šçŸ¥ç›‘å¬å™¨
        notifyConversationChanged(conversationID: conversationID)
        
        IMLogger.shared.info("Marked conversation as read: \(conversationID)")
    }
    
    /// è·å–æ€»æœªè¯»æ•°
    public func getTotalUnreadCount() -> Int {
        return database.getTotalUnreadCount()
    }
    
    /// è®¾ç½®å…æ‰“æ‰°
    public func setMuted(conversationID: String, muted: Bool) throws {
        let realm = try database.getRealm()
        
        try realm.write {
            if let conversation = realm.object(ofType: IMConversation.self, forPrimaryKey: conversationID) {
                conversation.isMuted = muted
            }
        }
        
        // é€šçŸ¥ç›‘å¬å™¨
        notifyConversationChanged(conversationID: conversationID)
    }
}
```

### 4. æ¶ˆæ¯æ¥æ”¶æ—¶è‡ªåŠ¨æ›´æ–°

```swift
// IMMessageManager.swift

extension IMMessageManager {
    
    private func handleReceivedMessage(_ message: IMMessage) {
        // ä¿å­˜æ¶ˆæ¯
        try? database.saveMessage(message)
        
        // åˆ¤æ–­ï¼šæ˜¯å¦éœ€è¦å¢åŠ æœªè¯»æ•°
        let shouldIncrement = message.direction == .receive && 
                             !isCurrentConversationActive(message.conversationID)
        
        if shouldIncrement {
            // å¢åŠ æœªè¯»æ•°
            try? database.incrementUnreadCount(conversationID: message.conversationID)
        }
        
        // é€šçŸ¥ç›‘å¬å™¨
        notifyMessageListeners(message)
    }
    
    private func isCurrentConversationActive(_ conversationID: String) -> Bool {
        // åˆ¤æ–­å½“å‰æ˜¯å¦æ­£åœ¨æŸ¥çœ‹è¯¥ä¼šè¯
        // å¯ä»¥é€šè¿‡è®¾ç½® currentConversationID æ¥è¿½è¸ª
        return currentConversationID == conversationID
    }
}
```

---

## ä½¿ç”¨ç¤ºä¾‹

### Example 1: ä¼šè¯åˆ—è¡¨æ˜¾ç¤ºæœªè¯»æ•°

```swift
class ConversationListViewController: UITableViewController {
    
    var conversations: [IMConversation] = []
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: "ConversationCell", for: indexPath)
        let conversation = conversations[indexPath.row]
        
        // æ˜¾ç¤ºä¼šè¯æ ‡é¢˜
        cell.textLabel?.text = conversation.title
        
        // æ˜¾ç¤ºæœªè¯»æ•°
        let unreadCount = IMClient.shared.conversationManager.getUnreadCount(
            conversationID: conversation.conversationID
        )
        
        if unreadCount > 0 {
            cell.detailTextLabel?.text = "[\(unreadCount)]"
            cell.detailTextLabel?.textColor = .red
        } else {
            cell.detailTextLabel?.text = ""
        }
        
        return cell
    }
}
```

### Example 2: æ‰“å¼€ä¼šè¯æ—¶æ ‡è®°å·²è¯»

```swift
class ChatViewController: UIViewController {
    
    let conversationID = "conv_123"
    
    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(animated)
        
        // æ ‡è®°ä¸ºå·²è¯»
        try? IMClient.shared.conversationManager.markAsRead(conversationID: conversationID)
        
        // è®¾ç½®å½“å‰æ´»è·ƒä¼šè¯ï¼ˆæ–°æ¶ˆæ¯ä¸å¢åŠ æœªè¯»æ•°ï¼‰
        IMClient.shared.messageManager.setCurrentConversation(conversationID)
    }
    
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(animated)
        
        // æ¸…é™¤å½“å‰æ´»è·ƒä¼šè¯
        IMClient.shared.messageManager.setCurrentConversation(nil)
    }
}
```

### Example 3: æ˜¾ç¤ºæ€»æœªè¯»æ•°ï¼ˆApp è§’æ ‡ï¼‰

```swift
class AppDelegate: UIResponder, UIApplicationDelegate {
    
    func updateBadgeCount() {
        let totalUnread = IMClient.shared.conversationManager.getTotalUnreadCount()
        
        // æ›´æ–° App å›¾æ ‡è§’æ ‡
        DispatchQueue.main.async {
            UIApplication.shared.applicationIconBadgeNumber = totalUnread
        }
    }
    
    func application(_ application: UIApplication, 
                    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        
        // è¯·æ±‚é€šçŸ¥æƒé™
        UNUserNotificationCenter.current().requestAuthorization(options: [.badge, .alert, .sound]) { granted, error in
            if granted {
                DispatchQueue.main.async {
                    application.registerForRemoteNotifications()
                }
            }
        }
        
        return true
    }
}
```

### Example 4: ç›‘å¬æœªè¯»æ•°å˜åŒ–

```swift
class ConversationListViewController: UITableViewController, IMConversationListener {
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        // æ·»åŠ ç›‘å¬å™¨
        IMClient.shared.conversationManager.addListener(self)
    }
    
    // MARK: - IMConversationListener
    
    func onConversationChanged(conversation: IMConversation) {
        // åˆ·æ–°ä¼šè¯åˆ—è¡¨
        DispatchQueue.main.async {
            if let index = self.conversations.firstIndex(where: { $0.conversationID == conversation.conversationID }) {
                let indexPath = IndexPath(row: index, section: 0)
                self.tableView.reloadRows(at: [indexPath], with: .none)
            }
        }
        
        // æ›´æ–°è§’æ ‡
        updateBadge()
    }
    
    private func updateBadge() {
        let totalUnread = IMClient.shared.conversationManager.getTotalUnreadCount()
        DispatchQueue.main.async {
            UIApplication.shared.applicationIconBadgeNumber = totalUnread
        }
    }
}
```

### Example 5: å…æ‰“æ‰°åŠŸèƒ½

```swift
class ConversationSettingsViewController: UITableViewController {
    
    @IBAction func muteToggled(_ sender: UISwitch) {
        try? IMClient.shared.conversationManager.setMuted(
            conversationID: conversationID,
            muted: sender.isOn
        )
        
        // æ›´æ–°æ€»æœªè¯»æ•°ï¼ˆå…æ‰“æ‰°ä¸è®¡å…¥ï¼‰
        updateTotalBadge()
    }
}
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. ä½¿ç”¨ç´¢å¼•

```swift
// IMConversation å·²æœ‰ç´¢å¼•
@Persisted(indexed: true) var updateTime: Int64
```

### 2. ç¼“å­˜æ€»æœªè¯»æ•°

```swift
class UnreadCountCache {
    private var cachedTotal: Int = 0
    private var lastUpdateTime: TimeInterval = 0
    private let cacheInterval: TimeInterval = 1.0  // 1ç§’ç¼“å­˜
    
    func getTotalUnreadCount(refresh: Bool = false) -> Int {
        let now = Date().timeIntervalSince1970
        
        if refresh || now - lastUpdateTime > cacheInterval {
            cachedTotal = database.getTotalUnreadCount()
            lastUpdateTime = now
        }
        
        return cachedTotal
    }
}
```

### 3. æ‰¹é‡æ›´æ–°

```swift
// åŒæ­¥ç¦»çº¿æ¶ˆæ¯æ—¶ï¼Œæ‰¹é‡æ›´æ–°æœªè¯»æ•°
func syncOfflineMessages(messages: [IMMessage]) {
    var unreadCountChanges: [String: Int] = [:]
    
    for message in messages where message.direction == .receive {
        unreadCountChanges[message.conversationID, default: 0] += 1
    }
    
    // æ‰¹é‡æ›´æ–°
    try? database.batchUpdateUnreadCount(unreadCountChanges)
}
```

---

## æµ‹è¯•åœºæ™¯

### 1. æ¥æ”¶æ¶ˆæ¯å¢åŠ æœªè¯»
```
Given: ä¼šè¯ A æœªè¯»æ•°ä¸º 0
When: æ”¶åˆ° 3 æ¡æ–°æ¶ˆæ¯
Then: æœªè¯»æ•°å˜ä¸º 3
```

### 2. æ‰“å¼€ä¼šè¯æ¸…é›¶
```
Given: ä¼šè¯ A æœªè¯»æ•°ä¸º 5
When: æ‰“å¼€ä¼šè¯ A
Then: æœªè¯»æ•°å˜ä¸º 0
```

### 3. è‡ªå·±å‘é€ä¸è®¡å…¥
```
Given: ä¼šè¯ A æœªè¯»æ•°ä¸º 0
When: è‡ªå·±å‘é€æ¶ˆæ¯
Then: æœªè¯»æ•°ä»ä¸º 0
```

### 4. å…æ‰“æ‰°ä¸è®¡å…¥æ€»æ•°
```
Given: ä¼šè¯ A æœªè¯» 5ï¼Œå…æ‰“æ‰°ï¼›ä¼šè¯ B æœªè¯» 3ï¼Œæœªå…æ‰“æ‰°
When: è®¡ç®—æ€»æœªè¯»æ•°
Then: æ€»æœªè¯»æ•°ä¸º 3ï¼ˆä¸åŒ…æ‹¬ Aï¼‰
```

### 5. å¤šç«¯åŒæ­¥
```
Given: åœ¨è®¾å¤‡ A ä¸Šæ ‡è®°ä¸ºå·²è¯»
When: è®¾å¤‡ B åŒæ­¥
Then: è®¾å¤‡ B çš„æœªè¯»æ•°ä¹Ÿæ¸…é›¶
```

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. âœ… **å®æ—¶æ›´æ–°**ï¼šæ”¶åˆ°æ¶ˆæ¯ç«‹å³æ›´æ–°æœªè¯»æ•°
2. âœ… **è‡ªåŠ¨æ¸…é›¶**ï¼šæ‰“å¼€ä¼šè¯è‡ªåŠ¨æ ‡è®°å·²è¯»
3. âœ… **æ€»æ•°ç»Ÿè®¡**ï¼šæ˜¾ç¤º App è§’æ ‡
4. âœ… **å…æ‰“æ‰°**ï¼šå…æ‰“æ‰°ä¼šè¯ä¸è®¡å…¥æ€»æ•°
5. âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨ç¼“å­˜å’Œæ‰¹é‡æ›´æ–°

### é¢„æœŸæ•ˆæœ

| åŠŸèƒ½ | æ•ˆæœ |
|------|------|
| æœªè¯»æé†’ | âœ… æ¸…æ™°æ˜äº† |
| è§’æ ‡æ˜¾ç¤º | âœ… å®æ—¶æ›´æ–° |
| æ€§èƒ½ | âœ… æµç•…æ— å¡é¡¿ |

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¶é—´**ï¼š2025-10-24  
**ä¸‹ä¸€æ­¥**ï¼šå¼€å§‹å®ç°ä»£ç 

